<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capability-Based Coordination Framework - Technical Repository</title>
    <style>
        /* Main Navigation Styles */
        .main-navigation {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .nav-container h2 {
            color: white;
            margin: 0 0 15px 0;
            text-align: center;
            font-size: 1.8em;
        }

        .nav-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .nav-link {
            color: #ecf0f1;
            text-decoration: none;
            padding: 12px 20px;
            border-radius: 6px;
            font-weight: bold;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-link:hover {
            background: rgba(255,255,255,0.1);
            color: #3498db;
        }

        .nav-link.active {
            background: #3498db;
            color: white;
        }

        /* Framework Styles */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            margin: 0 0 10px 0;
            font-size: 2.5em;
            font-weight: 700;
        }

        .header p {
            margin: 0;
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            padding: 30px;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0,0,0,0.1);
        }

        .section h2 {
            color: #1e3c72;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .demo-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .demo-card:hover {
            transform: translateY(-5px);
            border-color: #667eea;
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }

        .demo-card h3 {
            color: #1e3c72;
            margin-top: 0;
            margin-bottom: 15px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #333;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9em;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 1000px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            position: relative;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            right: 15px;
            top: 10px;
        }

        .close:hover,
        .close:focus {
            color: #000;
        }

        .slider-container {
            margin: 20px 0;
        }

        .slider-container label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #1e3c72;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
            margin-bottom: 10px;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
        }

        .value-display {
            font-weight: bold;
            color: #1e3c72;
        }

        .result-display {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }

        .result-score {
            font-size: 2em;
            font-weight: bold;
            color: #1e3c72;
            margin-bottom: 10px;
        }

        .interpretation {
            font-size: 0.9em;
            color: #666;
            margin-top: 10px;
        }

        .agent-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .agent-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .agent-card:hover, .agent-card.selected {
            border-color: #667eea;
            background: #e3f2fd;
        }

        .agent-card h4 {
            margin: 0 0 10px 0;
            color: #1e3c72;
        }

        .agent-card p {
            margin: 5px 0;
            font-size: 0.9em;
        }

        .agent-card .identity-kernel {
            background: #f0f8ff;
            padding: 8px;
            border-radius: 4px;
            margin-top: 8px;
            font-size: 0.85em;
            color: #2c5aa0;
        }

        .coordination-result {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #667eea;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .feature-list {
            list-style: none;
            padding: 0;
        }

        .feature-list li {
            padding: 10px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        .feature-list li:before {
            content: "âœ“";
            color: #27ae60;
            font-weight: bold;
            margin-right: 10px;
        }

        .agent-sample-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        /* Agent Builder Specific Styles */
        .coordination-prediction {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            border-left: 4px solid #667eea;
        }

        .coordination-prediction h5 {
            margin: 0 0 5px 0;
            color: #1e3c72;
        }

        .coordination-prediction p {
            margin: 0;
            font-size: 0.9em;
        }

        .two-column {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .column {
            flex: 1;
            min-width: 300px;
        }

        @media (max-width: 768px) {
            .nav-links {
                flex-direction: column;
                gap: 10px;
            }
            
            .demo-grid {
                grid-template-columns: 1fr;
            }
            
            .agent-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 95%;
                margin: 10% auto;
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .content {
                padding: 20px;
            }

            .two-column {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <nav class="main-navigation">
        <div class="nav-container">
            <h2>FAIM-QIRF Framework Repository</h2>
            <div class="nav-links">
                <a href="index.html" class="nav-link active">Framework Home & Demos</a>
                <a href="mathematical-foundations.html" class="nav-link">Mathematical Foundations</a>
                <a href="empirical-protocols.html" class="nav-link">Empirical Protocols</a>
                <a href="implementation-guidelines.html" class="nav-link">Implementation Guidelines</a>
                <a href="software-tools.html" class="nav-link">Software Tools</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="header">
            <h1>Capability-Based Coordination Framework</h1>
            <p>Interactive Repository for FAIM-QIRF Research & Applications</p>
        </div>

        <div class="content">
            <div class="section">
                <h2>Welcome to the Interactive Framework</h2>
                <p>This repository provides working demonstrations of the Capability-Based Coordination Framework (FAIM-QIRF). The framework enables coordination across authentic differences through functional equivalence rather than requiring shared beliefs or values.</p>
                
                <p><strong>For Newcomers:</strong> Start with the interactive demos below to see the framework in action. Each tool demonstrates core concepts that are fully formalized in our mathematical foundations.</p>
                
                <p><strong>For Academics:</strong> The complete mathematical specifications, empirical protocols, and implementation guidelines provide the rigorous foundation needed for peer review and replication.</p>
            </div>

            <div class="section">
                <h2>Interactive Demonstrations</h2>
                <p>Experience the framework through working tools that implement our mathematical specifications:</p>

                <div class="demo-grid">
                    <div class="demo-card">
                        <h3>ATCF Calculator</h3>
                        <p>Calculate Adaptive Temporal Coherence Function scores to measure how well an agent maintains coherent identity while adapting over time.</p>
                        <ul class="feature-list">
                            <li>Real-time ATCF calculation</li>
                            <li>Component breakdown analysis</li>
                            <li>Identity coherence measurement</li>
                            <li>Temporal integration assessment</li>
                        </ul>
                        <button class="btn" onclick="openATCFCalculator()">Launch ATCF Calculator</button>
                    </div>

                    <div class="demo-card">
                        <h3>Agent Coordination Assessment</h3>
                        <p>Explore how different agents can coordinate despite having different beliefs, values, and cognitive architectures across diverse backgrounds.</p>
                        <ul class="feature-list">
                            <li>6 realistic diverse agent examples</li>
                            <li>Cross-cultural coordination analysis</li>
                            <li>Neurodiversity integration</li>
                            <li>Professional background diversity</li>
                        </ul>
                        <button class="btn btn-secondary" onclick="openCoordinationDemo()">Try Demo</button>
                    </div>

                    <div class="demo-card">
                        <h3>Cultural Framework Explorer</h3>
                        <p>Discover how the same coordination principles apply across different cultural and cognitive frameworks.</p>
                        <ul class="feature-list">
                            <li>Cross-cultural validation</li>
                            <li>Framework comparison tools</li>
                            <li>Universal principle identification</li>
                            <li>Adaptation guidelines</li>
                        </ul>
                        <button class="btn" onclick="openCulturalExplorer()">Explore Frameworks</button>
                    </div>

                    <div class="demo-card">
                        <h3>Build Your Own Agent</h3>
                        <p>Create a custom agent with your own BROA+ configuration and see how it coordinates with existing agents.</p>
                        <ul class="feature-list">
                            <li>Custom belief, rule, and value settings</li>
                            <li>Real-time ATCF calculation</li>
                            <li>Coordination prediction with existing agents</li>
                            <li>Export agent configurations</li>
                        </ul>
                        <button class="btn" onclick="openAgentBuilder()">Build Agent</button>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>Research Applications</h2>
                <p>The framework has been validated across multiple domains:</p>
                
                <div class="demo-grid">
                    <div class="demo-card">
                        <h3>Therapeutic Applications</h3>
                        <p>Temporal coherence therapy showing significant improvements in anxiety reduction and decision-making coherence.</p>
                        <p><strong>Current Results:</strong> Effect size d = 0.73 (N = 89)</p>
                    </div>

                    <div class="demo-card">
                        <h3>Cross-Cultural Gaming</h3>
                        <p>International coordination studies demonstrating enhanced performance in diverse teams using capability-based coordination.</p>
                        <p><strong>Current Results:</strong> 52% improvement over traditional approaches</p>
                    </div>

                    <div class="demo-card">
                        <h3>AI-Human Coordination</h3>
                        <p>AI systems implementing PRF-adaptation showing improved coordination with human partners across domains.</p>
                        <p><strong>Current Results:</strong> 34% improvement in medical diagnosis tasks</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ATCF Calculator Modal -->
    <div id="atcfModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeATCFCalculator()">&times;</span>
            <h2>ATCF Calculator</h2>
            <p>Adjust the sliders to see how different factors contribute to overall temporal coherence:</p>

            <div class="slider-container">
                <label for="historical">Historical Continuity (HC): <span id="historicalValue" class="value-display">0.5</span></label>
                <input type="range" id="historical" class="slider" min="0" max="1" step="0.01" value="0.5" oninput="updateATCF()">
                <p class="interpretation">How well the agent maintains narrative connections between past and present</p>
            </div>

            <div class="slider-container">
                <label for="present">Present Integration (PI): <span id="presentValue" class="value-display">0.5</span></label>
                <input type="range" id="present" class="slider" min="0" max="1" step="0.01" value="0.5" oninput="updateATCF()">
                <p class="interpretation">Coherence of current beliefs, emotions, intentions, and actions</p>
            </div>

            <div class="slider-container">
                <label for="prospective">Prospective Coherence (PC): <span id="prospectiveValue" class="value-display">0.5</span></label>
                <input type="range" id="prospective" class="slider" min="0" max="1" step="0.01" value="0.5" oninput="updateATCF()">
                <p class="interpretation">Alignment between future plans and core identity</p>
            </div>

            <div class="slider-container">
                <label for="metaconstructor">Meta-Constructor Capacity (MCC): <span id="metaconstructorValue" class="value-display">0.5</span></label>
                <input type="range" id="metaconstructor" class="slider" min="0" max="1" step="0.01" value="0.5" oninput="updateATCF()">
                <p class="interpretation">Ability to modify beliefs while maintaining coherent reasoning</p>
            </div>

            <div class="result-display">
                <div class="result-score" id="atcfScore">0.50</div>
                <p><strong>ATCF Score Interpretation:</strong></p>
                <p id="atcfInterpretation">Moderate temporal coherence. The agent shows balanced integration across time scales.</p>
            </div>

            <div class="agent-sample-buttons">
                <button class="btn btn-small" onclick="loadSampleAgent('tanaka')">Dr. Tanaka (Collectivist)</button>
                <button class="btn btn-small" onclick="loadSampleAgent('maya')">Maya (ADHD Engineer)</button>
                <button class="btn btn-small" onclick="loadSampleAgent('fischer')">Dr. Fischer (Systematic)</button>
                <button class="btn btn-small" onclick="loadSampleAgent('clara')">Elder Clara (Indigenous)</button>
                <button class="btn btn-small" onclick="loadSampleAgent('alex')">Alex (Non-Binary Artist)</button>
                <button class="btn btn-small" onclick="loadSampleAgent('roberto')">Roberto (Manager)</button>
            </div>
        </div>
    </div>

    <!-- Coordination Demo Modal -->
    <div id="coordinationModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeCoordinationDemo()">&times;</span>
            <h2>Agent Coordination Assessment</h2>
            <p>Select two agents to analyze their coordination potential across authentic differences:</p>

            <div class="agent-grid" id="agentGrid">
                <!-- Agent cards will be populated by JavaScript -->
            </div>

            <div id="coordinationResults" style="display: none;">
                <div class="coordination-result">
                    <h3>Coordination Analysis</h3>
                    <div id="coordinationScore"></div>
                    <div id="coordinationExplanation"></div>
                </div>
            </div>

            <div class="loading" id="coordinationLoading">
                <div class="spinner"></div>
                <p>Analyzing coordination potential...</p>
            </div>
        </div>
    </div>

    <!-- Cultural Explorer Modal -->
    <div id="culturalModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeCulturalExplorer()">&times;</span>
            <h2>Cultural Framework Explorer</h2>
            <p>Explore how coordination principles adapt across different cultural contexts:</p>

            <div class="demo-grid">
                <div class="demo-card">
                    <h3>Individualistic Framework</h3>
                    <p>Emphasis on personal autonomy and individual decision-making authority.</p>
                    <button class="btn" onclick="loadCulturalFramework('individualistic')">Explore</button>
                </div>

                <div class="demo-card">
                    <h3>Collectivistic Framework</h3>
                    <p>Focus on group harmony and collective decision-making processes.</p>
                    <button class="btn" onclick="loadCulturalFramework('collectivistic')">Explore</button>
                </div>

                <div class="demo-card">
                    <h3>Hierarchical Framework</h3>
                    <p>Structured authority relationships and formal coordination protocols.</p>
                    <button class="btn" onclick="loadCulturalFramework('hierarchical')">Explore</button>
                </div>
            </div>

            <div id="culturalResults" style="display: none;">
                <div class="coordination-result">
                    <h3 id="culturalTitle"></h3>
                    <div id="culturalDescription"></div>
                    <div id="culturalPrinciples"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Agent Builder Modal -->
    <div id="agentBuilderModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAgentBuilder()">&times;</span>
            <h2>Build Your Own Agent</h2>
            
            <div class="two-column">
                <!-- Left Column - Agent Configuration -->
                <div class="column">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
    <h3>Agent Configuration</h3>
    <button class="btn btn-small" onclick="toggleInfoPanel()" id="infoToggleBtn">Show Definitions</button>
</div> <!-- Information Panel (Hidden by default) -->
<div id="infoPanel" style="display: none; background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #667eea;">
    <h4 style="margin-top: 0;">Framework Definitions</h4>
    <p><strong>BROA+ Components:</strong> Beliefs (what the agent considers true), Rules (decision-making procedures), Ontology (fundamental categories for understanding reality), and Authenticity+ (identity preservation criteria).</p>
    
    <p><strong>ATCF Score:</strong> Adaptive Temporal Coherence Function - measures how well an agent maintains coherent identity while adapting over time across past, present, and future.</p>
    
    <p><strong>Identity Kernel:</strong> The core aspects of an agent's identity that remain stable even as beliefs and behaviors adapt to new situations.</p>
    
    <p><strong>Coordination Potential:</strong> How effectively two agents can work together despite having different beliefs, values, and cognitive architectures through functional equivalence.</p>
    
    <button class="btn btn-small" onclick="toggleInfoPanel()" style="margin-top: 10px;">Hide Definitions</button>
</div>
                    
                    <div class="slider-container">
                        <label for="agentName">Agent Name:</label>
                        <input type="text" id="agentName" placeholder="Enter agent name" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ddd;">
                    </div>

                    <div class="slider-container">
                        <label for="agentBackground">Cultural Background:</label>
                        <select id="agentBackground" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ddd;" onchange="updateCustomAgent()">
                            <option value="individualistic">Individualistic</option>
                            <option value="collectivistic">Collectivistic</option>
                            <option value="hierarchical">Hierarchical</option>
                            <option value="egalitarian">Egalitarian</option>
                            <option value="mixed">Mixed/Hybrid</option>
                        </select>
                    </div>

                    <h4>Core Beliefs (How strongly does this agent believe in...)</h4>
                    
                    <div class="slider-container">
                        <label for="beliefAutonomy">Personal Autonomy: <span id="beliefAutonomyValue" class="value-display">0.5</span></label>
                        <input type="range" id="beliefAutonomy" class="slider" min="0" max="1" step="0.01" value="0.5" oninput="updateCustomAgent()">
                    </div>

                    <div class="slider-container">
                        <label for="beliefCollective">Collective Responsibility: <span id="beliefCollectiveValue" class="value-display">0.5</span></label>
                        <input type="range" id="beliefCollective" class="slider" min="0" max="1" step="0.01" value="0.5" oninput="updateCustomAgent()">
                    </div>

                    <div class="slider-container">
                        <label for="beliefEvidence">Evidence-Based Reasoning: <span id="beliefEvidenceValue" class="value-display">0.5</span></label>
                        <input type="range" id="beliefEvidence" class="slider" min="0" max="1" step="0.01" value="0.5" oninput="updateCustomAgent()">
                    </div>

                    <div class="slider-container">
                        <label for="beliefTradition">Traditional Authority: <span id="beliefTraditionValue" class="value-display">0.5</span></label>
                        <input type="range" id="beliefTradition" class="slider" min="0" max="1" step="0.01" value="0.5" oninput="updateCustomAgent()">
                    </div>

                    <h4>Decision-Making Rules</h4>
                    
                    <div class="slider-container">
                        <label for="ruleConsensus">Consensus Building: <span id="ruleConsensusValue" class="value-display">0.5</span></label>
                        <input type="range" id="ruleConsensus" class="slider" min="0" max="1" step="0.01" value="0.5" oninput="updateCustomAgent()">
                    </div>

                    <div class="slider-container">
                        <label for="ruleSpeed">Quick Decision Making: <span id="ruleSpeedValue" class="value-display">0.5</span></label>
                        <input type="range" id="ruleSpeed" class="slider" min="0" max="1" step="0.01" value="0.5" oninput="updateCustomAgent()">
                    </div>

                    <div class="slider-container">
                        <label for="ruleFlexibility">Adaptability/Flexibility: <span id="ruleFlexibilityValue" class="value-display">0.5</span></label>
                        <input type="range" id="ruleFlexibility" class="slider" min="0" max="1" step="0.01" value="0.5" oninput="updateCustomAgent()">
                    </div>
                </div>

                <!-- Right Column - Results -->
                <div class="column">
                    <h3>Agent Profile</h3>
                    
                    <div class="result-display" id="customAgentProfile">
                        <h4 id="customAgentName">Custom Agent</h4>
                        <p><strong>Cultural Background:</strong> <span id="customAgentBg">Individualistic</span></p>
                        <p><strong>Communication Style:</strong> <span id="customCommStyle">Balanced</span></p>
                        <p><strong>ATCF Score:</strong> <span id="customATCF">0.50</span></p>
                        <div id="customIdentityKernel" style="margin-top: 10px; padding: 10px; background: #f0f8ff; border-radius: 4px;">
                            <strong>Generated Identity Kernel:</strong> <span id="customKernelText">Balanced individual with moderate coordination preferences</span>
                        </div>
                    </div>

                    <h4>Coordination Predictions</h4>
                    <div id="coordinationPredictions">
                        <p>Build your agent to see coordination potential with existing agents.</p>
                    </div>

                    <div style="margin-top: 20px;">
                        <button class="btn" onclick="saveCustomAgent()">Save Agent</button>
                        <button class="btn btn-secondary" onclick="testCoordinationWithAll()">Test Coordination</button>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <button class="btn btn-small" onclick="loadPresetAgent('entrepreneur')">Load Entrepreneur</button>
                        <button class="btn btn-small" onclick="loadPresetAgent('therapist')">Load Therapist</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        console.log('Loading FAIM-QIRF Framework Application...');

        // Agent data structure
        const sampleAgentData = {
            tanaka: {
                id: 'tanaka_001',
                name: 'Dr. Kenji Tanaka',
                subtitle: 'Japanese Collectivist Physician',
                cultural_background: 'Japanese collectivistic',
                profession: 'Medical Doctor',
                age_group: 'mid-career',
                neurodiversity: 'neurotypical',
                atcf_components: {
                    historical_continuity: 0.89,
                    present_integration: 0.86,
                    prospective_coherence: 0.84,
                    meta_constructor_capacity: 0.81
                },
                coordination_capabilities: {
                    communication_style: 'consensus_building',
                    conflict_management: 'harmony_preservation',
                    trust_building: 'relationship_cultivation',
                    adaptation_style: 'collective_wisdom'
                },
                identity_kernel: 'Traditional Japanese medical values, collectivist orientation, harmony-seeking'
            },
            maya: {
                id: 'maya_002',
                name: 'Maya Patel',
                subtitle: 'ADHD Software Engineer',
                cultural_background: 'Western individualistic',
                profession: 'Software Engineer',
                age_group: 'young_adult',
                neurodiversity: 'ADHD',
                atcf_components: {
                    historical_continuity: 0.74,
                    present_integration: 0.78,
                    prospective_coherence: 0.71,
                    meta_constructor_capacity: 0.89
                },
                coordination_capabilities: {
                    communication_style: 'structured_flexibility',
                    conflict_management: 'creative_problem_solving',
                    trust_building: 'competence_demonstration',
                    adaptation_style: 'innovative_approaches'
                },
                identity_kernel: 'Neurodivergent innovation, creative flexibility, adaptive structures'
            },
            fischer: {
                id: 'fischer_003',
                name: 'Dr. Emma Fischer',
                subtitle: 'German Systematic Researcher',
                cultural_background: 'German individualistic',
                profession: 'Research Scientist',
                age_group: 'mid_career',
                neurodiversity: 'neurotypical',
                atcf_components: {
                    historical_continuity: 0.91,
                    present_integration: 0.94,
                    prospective_coherence: 0.88,
                    meta_constructor_capacity: 0.79
                },
                coordination_capabilities: {
                    communication_style: 'systematic_protocols',
                    conflict_management: 'methodical_resolution',
                    trust_building: 'reliability_demonstration',
                    adaptation_style: 'evidence_based_updating'
                },
                identity_kernel: 'Germanic systematic thinking, methodological precision, efficiency-oriented'
            },
            clara: {
                id: 'clara_004',
                name: 'Grandmother Clara Whitehorse',
                subtitle: 'Indigenous Community Elder',
                cultural_background: 'Indigenous community-oriented',
                profession: 'Community Elder/Wisdom Keeper',
                age_group: 'elder',
                neurodiversity: 'neurotypical',
                atcf_components: {
                    historical_continuity: 0.94,
                    present_integration: 0.88,
                    prospective_coherence: 0.91,
                    meta_constructor_capacity: 0.86
                },
                coordination_capabilities: {
                    communication_style: 'consensus_circles',
                    conflict_management: 'restorative_processes',
                    trust_building: 'relationship_cultivation',
                    adaptation_style: 'traditional_wisdom_integration'
                },
                identity_kernel: 'Indigenous worldview, seven-generation thinking, relational ontology'
            },
            alex: {
                id: 'alex_005',
                name: 'Alex Chen',
                subtitle: 'Non-Binary Artist & College Student',
                cultural_background: 'Progressive Western',
                profession: 'Artist/Student',
                age_group: 'young_adult',
                neurodiversity: 'neurotypical',
                atcf_components: {
                    historical_continuity: 0.73,
                    present_integration: 0.82,
                    prospective_coherence: 0.79,
                    meta_constructor_capacity: 0.91
                },
                coordination_capabilities: {
                    communication_style: 'inclusive_dialogue',
                    conflict_management: 'identity_affirming_processes',
                    trust_building: 'authentic_vulnerability',
                    adaptation_style: 'creative_exploration'
                },
                identity_kernel: 'Non-binary identity, artistic expression, social justice orientation'
            },
            roberto: {
                id: 'roberto_006',
                name: 'Roberto Silva',
                subtitle: 'Mid-Career Engineering Manager',
                cultural_background: 'Latino individualistic',
                profession: 'Engineering Manager',
                age_group: 'mid_career',
                neurodiversity: 'neurotypical',
                atcf_components: {
                    historical_continuity: 0.85,
                    present_integration: 0.87,
                    prospective_coherence: 0.83,
                    meta_constructor_capacity: 0.80
                },
                coordination_capabilities: {
                    communication_style: 'balanced_negotiation',
                    conflict_management: 'pragmatic_resolution',
                    trust_building: 'consistent_reliability',
                    adaptation_style: 'practical_wisdom'
                },
                identity_kernel: 'Mid-career balance, mentorship orientation, practical wisdom'
            }
        };

        const culturalFrameworks = {
            individualistic: {
                name: "Individualistic Framework",
                description: "Emphasizes personal autonomy, individual rights, and self-directed decision-making.",
                coordination_principles: [
                    "Respect for individual autonomy and choice",
                    "Clear individual accountability and responsibility",
                    "Direct communication and explicit agreements",
                    "Merit-based recognition and advancement",
                    "Minimal interference with personal decisions"
                ],
                atcf_adaptations: {
                    historical_continuity: "Personal narrative and individual growth trajectory",
                    present_integration: "Alignment between personal values and actions",
                    prospective_coherence: "Individual goal achievement and self-actualization",
                    meta_constructor_capacity: "Personal learning and self-improvement"
                }
            },
            collectivistic: {
                name: "Collectivistic Framework",
                description: "Prioritizes group harmony, collective welfare, and community-based decision-making.",
                coordination_principles: [
                    "Collective welfare over individual preferences",
                    "Consensus-building and shared decision-making",
                    "Contextual communication with attention to harmony",
                    "Role-based responsibilities within the group",
                    "Long-term relationship preservation"
                ],
                atcf_adaptations: {
                    historical_continuity: "Community traditions and collective memory",
                    present_integration: "Harmony between individual and group needs",
                    prospective_coherence: "Community development and collective goals",
                    meta_constructor_capacity: "Collective learning and group adaptation"
                }
            },
            hierarchical: {
                name: "Hierarchical Framework",
                description: "Operates through structured authority relationships and formal coordination protocols.",
                coordination_principles: [
                    "Clear authority structures and chain of command",
                    "Formal procedures and standardized processes",
                    "Respect for expertise and positional authority",
                    "Structured communication channels",
                    "Systematic coordination and resource allocation"
                ],
                atcf_adaptations: {
                    historical_continuity: "Institutional memory and precedent",
                    present_integration: "Role clarity and organizational alignment",
                    prospective_coherence: "Strategic planning and institutional goals",
                    meta_constructor_capacity: "Organizational learning and process improvement"
                }
            }
        };

        const coordinationMatrix = {
            'tanaka-maya': 0.73,
            'tanaka-fischer': 0.69,
            'tanaka-clara': 0.87,
            'tanaka-alex': 0.71,
            'tanaka-roberto': 0.79,
            'maya-fischer': 0.68,
            'maya-clara': 0.76,
            'maya-alex': 0.84,
            'maya-roberto': 0.77,
            'fischer-clara': 0.65,
            'fischer-alex': 0.72,
            'fischer-roberto': 0.81,
            'clara-alex': 0.78,
            'clara-roberto': 0.74,
            'alex-roberto': 0.80
        };

        // Global variables
        let selectedAgents = [];

        // Initialize the application
        console.log('Initializing FAIM-QIRF Framework Application...');

        // ATCF Calculator Functions
        function openATCFCalculator() {
            console.log('Opening ATCF Calculator...');
            document.getElementById('atcfModal').style.display = 'block';
            updateATCF();
        }

        function closeATCFCalculator() {
            document.getElementById('atcfModal').style.display = 'none';
        }

        function updateATCF() {
            try {
                const historical = parseFloat(document.getElementById('historical').value);
                const present = parseFloat(document.getElementById('present').value);
                const prospective = parseFloat(document.getElementById('prospective').value);
                const metaconstructor = parseFloat(document.getElementById('metaconstructor').value);

                // Update value displays
                document.getElementById('historicalValue').textContent = historical.toFixed(2);
                document.getElementById('presentValue').textContent = present.toFixed(2);
                document.getElementById('prospectiveValue').textContent = prospective.toFixed(2);
                document.getElementById('metaconstructorValue').textContent = metaconstructor.toFixed(2);

                // Calculate ATCF (equal weights for demo)
                const atcfScore = (historical + present + prospective + metaconstructor) / 4;
                document.getElementById('atcfScore').textContent = atcfScore.toFixed(2);

                // Update interpretation
                let interpretation = '';
                if (atcfScore >= 0.85) {
                    interpretation = 'Excellent temporal coherence. The agent demonstrates exceptional integration across all time scales with strong adaptive capacity.';
                } else if (atcfScore >= 0.7) {
                    interpretation = 'Good temporal coherence. The agent shows solid integration with strong coordination potential.';
                } else if (atcfScore >= 0.5) {
                    interpretation = 'Moderate temporal coherence. The agent shows balanced integration across time scales with opportunities for enhancement.';
                } else {
                    interpretation = 'Lower temporal coherence. The agent may benefit from focused work on temporal integration and identity coherence.';
                }

                document.getElementById('atcfInterpretation').textContent = interpretation;
            } catch (error) {
                console.error('Error in updateATCF:', error);
            }
        }

        function loadSampleAgent(agentId) {
            try {
                console.log('Loading sample agent:', agentId);
                const agent = sampleAgentData[agentId];
                if (agent && agent.atcf_components) {
                    document.getElementById('historical').value = agent.atcf_components.historical_continuity;
                    document.getElementById('present').value = agent.atcf_components.present_integration;
                    document.getElementById('prospective').value = agent.atcf_components.prospective_coherence;
                    document.getElementById('metaconstructor').value = agent.atcf_components.meta_constructor_capacity;
                    updateATCF();
                } else {
                    console.error('Agent not found:', agentId);
                }
            } catch (error) {
                console.error('Error loading sample agent:', error);
            }
        }

        // Coordination Demo Functions
        function openCoordinationDemo() {
            console.log('Opening Coordination Demo...');
            document.getElementById('coordinationModal').style.display = 'block';
            selectedAgents = []; // Reset selection
            populateAgentGrid();
        }

        function closeCoordinationDemo() {
            document.getElementById('coordinationModal').style.display = 'none';
        }

        function populateAgentGrid() {
            try {
                const agentGrid = document.getElementById('agentGrid');
                agentGrid.innerHTML = '';
                
                Object.entries(sampleAgentData).forEach(([id, agent]) => {
                    const agentCard = document.createElement('div');
                    agentCard.className = 'agent-card';
                    agentCard.onclick = () => selectAgent(id, agentCard);
                    
                    agentCard.innerHTML = `
                        <h4>${agent.name}</h4>
                        <p><strong>${agent.subtitle}</strong></p>
                        <p><strong>Background:</strong> ${agent.cultural_background}</p>
                        <p><strong>Profession:</strong> ${agent.profession}</p>
                        <p><strong>Communication:</strong> ${agent.coordination_capabilities.communication_style.replace(/_/g, ' ')}</p>
                        <p><strong>ATCF Score:</strong> ${calculateATCFScore(agent).toFixed(2)}</p>
                        <div class="identity-kernel">
                            <strong>Identity Kernel:</strong> ${agent.identity_kernel}
                        </div>
                    `;
                    
                    agentGrid.appendChild(agentCard);
                });
                console.log('Agent grid populated with', Object.keys(sampleAgentData).length, 'agents');
            } catch (error) {
                console.error('Error populating agent grid:', error);
            }
        }

        function selectAgent(agentId, cardElement) {
            try {
                // Toggle selection
                if (cardElement.classList.contains('selected')) {
                    cardElement.classList.remove('selected');
                    const index = selectedAgents.indexOf(agentId);
                    if (index > -1) {
                        selectedAgents.splice(index, 1);
                    }
                } else {
                    cardElement.classList.add('selected');
                    selectedAgents.push(agentId);
                }

                // Limit to 2 agents
                if (selectedAgents.length > 2) {
                    const firstSelected = document.querySelector('.agent-card.selected');
                    if (firstSelected) {
                        firstSelected.classList.remove('selected');
                    }
                    selectedAgents.shift();
                }

                console.log('Selected agents:', selectedAgents);

                // Show coordination analysis if 2 agents selected
                if (selectedAgents.length === 2) {
                    analyzeCoordination();
                } else {
                    document.getElementById('coordinationResults').style.display = 'none';
                }
            } catch (error) {
                console.error('Error selecting agent:', error);
            }
        }

        function analyzeCoordination() {
            try {
                document.getElementById('coordinationLoading').style.display = 'block';
                document.getElementById('coordinationResults').style.display = 'none';
                
                setTimeout(() => {
                    const agent1 = sampleAgentData[selectedAgents[0]];
                    const agent2 = sampleAgentData[selectedAgents[1]];
                    
                    const coordinationKey = getCoordinationKey(selectedAgents[0], selectedAgents[1]);
                    const precomputedScore = coordinationMatrix[coordinationKey] || calculateCoordinationPotential(agent1, agent2);
                    
                    document.getElementById('coordinationLoading').style.display = 'none';
                    document.getElementById('coordinationResults').style.display = 'block';
                    
                    document.getElementById('coordinationScore').innerHTML = `
                        <div class="result-score">${precomputedScore.toFixed(2)}</div>
                        <p><strong>Coordination Potential Score</strong></p>
                    `;
                    
                    let explanation = '';
                    if (precomputedScore >= 0.8) {
                        explanation = 'High coordination potential. These agents have complementary capabilities and compatible coordination styles despite their differences.';
                    } else if (precomputedScore >= 0.7) {
                        explanation = 'Good coordination potential. These agents can coordinate effectively with some adaptation and mutual understanding.';
                    } else if (precomputedScore >= 0.6) {
                        explanation = 'Moderate coordination potential. With proper facilitation, these agents can achieve functional coordination.';
                    } else {
                        explanation = 'Lower coordination potential. These agents may need significant support structures for effective coordination.';
                    }
                    
                    explanation += `<br><br><strong>Agent Comparison:</strong><br>
                        â€¢ <strong>${agent1.name}:</strong> ${agent1.coordination_capabilities.communication_style.replace(/_/g, ' ')}<br>
                        â€¢ <strong>${agent2.name}:</strong> ${agent2.coordination_capabilities.communication_style.replace(/_/g, ' ')}<br><br>
                        <strong>Key Factors:</strong><br>
                        â€¢ Cultural framework compatibility: ${assessCulturalCompatibility(agent1, agent2)}<br>
                        â€¢ Communication style alignment: ${assessCommunicationAlignment(agent1, agent2)}<br>
                        â€¢ ATCF complementarity: ${assessATCFComplementarity(agent1, agent2)}<br>
                        â€¢ Neurodiversity considerations: ${assessNeurodiversityFactor(agent1, agent2)}`;
                    
                    document.getElementById('coordinationExplanation').innerHTML = explanation;
                }, 1500);
            } catch (error) {
                console.error('Error analyzing coordination:', error);
            }
        }

        function getCoordinationKey(agent1Id, agent2Id) {
            const sorted = [agent1Id, agent2Id].sort();
            return `${sorted[0]}-${sorted[1]}`;
        }

        function calculateCoordinationPotential(agent1, agent2) {
            const atcf1 = calculateATCFScore(agent1);
            const atcf2 = calculateATCFScore(agent2);
            return (atcf1 + atcf2) / 2; // Simplified calculation
        }

        function calculateATCFScore(agent) {
            const components = agent.atcf_components;
            return (components.historical_continuity + components.present_integration + 
                    components.prospective_coherence + components.meta_constructor_capacity) / 4;
        }

        function assessCulturalCompatibility(agent1, agent2) {
            if (agent1.cultural_background === agent2.cultural_background) {
                return 'High - shared cultural framework enables natural coordination';
            } else if (agent1.cultural_background.includes('collectiv') && agent2.cultural_background.includes('collectiv')) {
                return 'High - both collectivistic approaches align well';
            } else if (agent1.cultural_background.includes('individual') && agent2.cultural_background.includes('individual')) {
                return 'Good - both individualistic approaches can coordinate through clear agreements';
            } else {
                return 'Moderate - different frameworks require bridge-building and mutual adaptation';
            }
        }

        function assessCommunicationAlignment(agent1, agent2) {
            const style1 = agent1.coordination_capabilities.communication_style;
            const style2 = agent2.coordination_capabilities.communication_style;
            
            if (style1 === style2) {
                return 'High - identical communication styles enable smooth interaction';
            } else if ((style1.includes('consensus') && style2.includes('consensus')) || 
                       (style1.includes('systematic') && style2.includes('systematic'))) {
                return 'Good - complementary structured approaches';
            } else {
                return 'Moderate - different styles requiring adaptation and translation';
            }
        }

        function assessATCFComplementarity(agent1, agent2) {
            const score1 = calculateATCFScore(agent1);
            const score2 = calculateATCFScore(agent2);
            const avg = (score1 + score2) / 2;
            
            if (avg >= 0.85) {
                return 'Excellent - both agents show exceptional temporal coherence';
            } else if (avg >= 0.75) {
                return 'Good - both agents demonstrate strong coherence for coordination';
            } else if (avg >= 0.65) {
                return 'Moderate - adequate coherence with room for development';
            } else {
                return 'Lower - may need coherence development support';
            }
        }

        function assessNeurodiversityFactor(agent1, agent2) {
            const neuro1 = agent1.neurodiversity;
            const neuro2 = agent2.neurodiversity;
            
            if (neuro1 === neuro2) {
                return neuro1 === 'neurotypical' ? 
                    'Standard - both neurotypical' : 
                    'High compatibility - shared neurodivergent perspectives';
            } else {
                return 'Diverse perspectives - neurotypical/neurodivergent combination offers complementary strengths';
            }
        }

        // Cultural Explorer Functions
        function openCulturalExplorer() {
            console.log('Opening Cultural Explorer...');
            document.getElementById('culturalModal').style.display = 'block';
        }

        function closeCulturalExplorer() {
            document.getElementById('culturalModal').style.display = 'none';
        }

        function loadCulturalFramework(frameworkType) {
            try {
                const framework = culturalFrameworks[frameworkType];
                
                document.getElementById('culturalTitle').textContent = framework.name;
                document.getElementById('culturalDescription').innerHTML = `<p>${framework.description}</p>`;
                
                const principlesList = framework.coordination_principles.map(principle => 
                    `<li>${principle}</li>`
                ).join('');
                
                const adaptationsList = Object.entries(framework.atcf_adaptations).map(([component, adaptation]) =>
                    `<li><strong>${component.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase())}:</strong> ${adaptation}</li>`
                ).join('');
                
                document.getElementById('culturalPrinciples').innerHTML = `
                    <h4>Coordination Principles:</h4>
                    <ul>${principlesList}</ul>
                    <h4>ATCF Adaptations:</h4>
                    <ul>${adaptationsList}</ul>
                `;
                
                document.getElementById('culturalResults').style.display = 'block';
            } catch (error) {
                console.error('Error loading cultural framework:', error);
            }
        }

        // Agent Builder Functions
        function openAgentBuilder() {
            console.log('Opening Agent Builder...');
            document.getElementById('agentBuilderModal').style.display = 'block';
            updateCustomAgent();
        }

        function closeAgentBuilder() {
            document.getElementById('agentBuilderModal').style.display = 'none';
        }

        function updateCustomAgent() {
            try {
                // Get all values
                const name = document.getElementById('agentName').value || 'Custom Agent';
                const background = document.getElementById('agentBackground').value;
                
                const beliefAutonomy = parseFloat(document.getElementById('beliefAutonomy').value);
                const beliefCollective = parseFloat(document.getElementById('beliefCollective').value);
                const beliefEvidence = parseFloat(document.getElementById('beliefEvidence').value);
                const beliefTradition = parseFloat(document.getElementById('beliefTradition').value);
                
                const ruleConsensus = parseFloat(document.getElementById('ruleConsensus').value);
                const ruleSpeed = parseFloat(document.getElementById('ruleSpeed').value);
                const ruleFlexibility = parseFloat(document.getElementById('ruleFlexibility').value);

                // Update value displays
                document.getElementById('beliefAutonomyValue').textContent = beliefAutonomy.toFixed(2);
                document.getElementById('beliefCollectiveValue').textContent = beliefCollective.toFixed(2);
                document.getElementById('beliefEvidenceValue').textContent = beliefEvidence.toFixed(2);
                document.getElementById('beliefTraditionValue').textContent = beliefTradition.toFixed(2);
                document.getElementById('ruleConsensusValue').textContent = ruleConsensus.toFixed(2);
                document.getElementById('ruleSpeedValue').textContent = ruleSpeed.toFixed(2);
                document.getElementById('ruleFlexibilityValue').textContent = ruleFlexibility.toFixed(2);

                // Calculate derived values
                const customAgent = generateCustomAgent(name, background, {
                    beliefAutonomy, beliefCollective, beliefEvidence, beliefTradition,
                    ruleConsensus, ruleSpeed, ruleFlexibility
                });

                // Update display
                document.getElementById('customAgentName').textContent = name;
                document.getElementById('customAgentBg').textContent = background;
                document.getElementById('customCommStyle').textContent = customAgent.communication_style;
                document.getElementById('customATCF').textContent = customAgent.atcf_score.toFixed(2);
                document.getElementById('customKernelText').textContent = customAgent.identity_kernel;

                // Store custom agent globally for coordination testing
                window.customAgent = customAgent;

            } catch (error) {
                console.error('Error updating custom agent:', error);
            }
        }

        function generateCustomAgent(name, background, values) {
            // Calculate ATCF components based on input values
            const historical_continuity = (values.beliefTradition + values.beliefEvidence) / 2;
            const present_integration = (values.beliefAutonomy + values.beliefCollective + values.beliefEvidence) / 3;
            const prospective_coherence = (values.ruleFlexibility + values.beliefEvidence) / 2;
            const meta_constructor_capacity = (values.ruleFlexibility + values.ruleSpeed + (1 - values.beliefTradition)) / 3;

            const atcf_score = (historical_continuity + present_integration + prospective_coherence + meta_constructor_capacity) / 4;

            // Determine communication style
            let communication_style = 'balanced';
            if (values.ruleConsensus > 0.7) {
                communication_style = 'consensus_building';
            } else if (values.ruleSpeed > 0.7) {
                communication_style = 'direct_decisive';
            } else if (values.beliefAutonomy > 0.7) {
                communication_style = 'individual_focused';
            } else if (values.beliefCollective > 0.7) {
                communication_style = 'group_oriented';
            }

            // Generate identity kernel
            let identity_kernel = '';
            if (values.beliefAutonomy > 0.7) {
                identity_kernel += 'Autonomous ';
            }
            if (values.beliefCollective > 0.7) {
                identity_kernel += 'Community-oriented ';
            }
            if (values.beliefEvidence > 0.7) {
                identity_kernel += 'Evidence-based ';
            }
            if (values.beliefTradition > 0.7) {
                identity_kernel += 'Traditional ';
            }
            if (values.ruleFlexibility > 0.7) {
                identity_kernel += 'Adaptive ';
            }
            
            identity_kernel += background + ' agent with ';
            
            if (values.ruleConsensus > 0.6) {
                identity_kernel += 'collaborative decision-making preferences';
            } else if (values.ruleSpeed > 0.6) {
                identity_kernel += 'efficient action-oriented approach';
            } else {
                identity_kernel += 'balanced coordination style';
            }

            return {
                id: 'custom_agent',
                name: name,
                cultural_background: background,
                atcf_components: {
                    historical_continuity,
                    present_integration, 
                    prospective_coherence,
                    meta_constructor_capacity
                },
                atcf_score,
                communication_style,
                identity_kernel,
                coordination_capabilities: {
                    communication_style,
                    conflict_management: values.ruleConsensus > 0.6 ? 'collaborative' : 'direct',
                    trust_building: values.beliefEvidence > 0.6 ? 'competence_demonstration' : 'relationship_cultivation',
                    adaptation_style: values.ruleFlexibility > 0.6 ? 'flexible_adaptation' : 'structured_consistency'
                },
                custom_values: values
            };
        }

        function testCoordinationWithAll() {
            if (!window.customAgent) {
                updateCustomAgent();
            }
            
            const predictions = [];
            Object.entries(sampleAgentData).forEach(([id, agent]) => {
                const score = calculateCoordinationPotential(window.customAgent, agent);
                predictions.push({
                    agent: agent.name,
                    score: score,
                    explanation: generateCoordinationExplanation(window.customAgent, agent, score)
                });
            });

            // Sort by score
            predictions.sort((a, b) => b.score - a.score);

            // Display results
            const html = predictions.map(p => `
                <div class="coordination-prediction">
                    <h5>${p.agent}: ${p.score.toFixed(2)}</h5>
                    <p>${p.explanation}</p>
                </div>
            `).join('');

            document.getElementById('coordinationPredictions').innerHTML = html;
        }

        function generateCoordinationExplanation(customAgent, otherAgent, score) {
            if (score >= 0.8) {
                return `Highly compatible - similar ${customAgent.communication_style} and ${otherAgent.coordination_capabilities.communication_style} approaches`;
            } else if (score >= 0.6) {
                return `Good potential - complementary ${customAgent.cultural_background} and ${otherAgent.cultural_background} frameworks`;
            } else {
                return `Moderate potential - different approaches may require structured coordination`;
            }
        }

        function loadPresetAgent(type) {
            if (type === 'entrepreneur') {
                document.getElementById('agentName').value = 'Tech Entrepreneur';
                document.getElementById('agentBackground').value = 'individualistic';
                document.getElementById('beliefAutonomy').value = 0.9;
                document.getElementById('beliefCollective').value = 0.3;
                document.getElementById('beliefEvidence').value = 0.8;
                document.getElementById('beliefTradition').value = 0.2;
                document.getElementById('ruleConsensus').value = 0.4;
                document.getElementById('ruleSpeed').value = 0.9;
                document.getElementById('ruleFlexibility').value = 0.8;
            } else if (type === 'therapist') {
                document.getElementById('agentName').value = 'Clinical Therapist';
                document.getElementById('agentBackground').value = 'collectivistic';
                document.getElementById('beliefAutonomy').value = 0.6;
                document.getElementById('beliefCollective').value = 0.8;
                document.getElementById('beliefEvidence').value = 0.9;
                document.getElementById('beliefTradition').value = 0.5;
                document.getElementById('ruleConsensus').value = 0.8;
                document.getElementById('ruleSpeed').value = 0.3;
                document.getElementById('ruleFlexibility').value = 0.7;
            }
            updateCustomAgent();
        }

        function saveCustomAgent() {
            if (!window.customAgent) {
                updateCustomAgent();
            }
            
            const agentData = JSON.stringify(window.customAgent, null, 2);
            const blob = new Blob([agentData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `${window.customAgent.name.replace(/\s+/g, '_')}_agent.json`;
            a.click();
            
            URL.revokeObjectURL(url);
            
            alert('Agent configuration saved!');
        }

        function toggleInfoPanel() {
            const panel = document.getElementById('infoPanel');
            const btn = document.getElementById('infoToggleBtn');
            
            if (panel.style.display === 'none') {
                panel.style.display = 'block';
                btn.textContent = 'Hide Definitions';
            } else {
                panel.style.display = 'none';
                btn.textContent = 'Show Definitions';
            }
        }

        // Modal click handler
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        };

        console.log('FAIM-QIRF Framework Application loaded successfully!');
        console.log('Available agents:', Object.keys(sampleAgentData));
        function toggleInfoPanel() {
    const panel = document.getElementById('infoPanel');
    const btn = document.getElementById('infoToggleBtn');
    
    if (panel.style.display === 'none') {
        panel.style.display = 'block';
        btn.textContent = 'Hide Definitions';
    } else {
        panel.style.display = 'none';
        btn.textContent = 'Show Definitions';
    }
}
    </script>
</body>
</html>
